{% extends 'base.html' %}
{% load static %}

{% block content %}
    <div class="w-full px-4">

        <!-- ğŸ› í•„í„° -->
        <section class="bg-white shadow rounded-xl p-4 mb-6">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                <select id="crop" class="border rounded p-2">
                    {% for crop in crops %}
                        <option value="{{ crop }}">{{ crop }}</option>
                    {% endfor %}
                </select>

                <select id="year" class="border rounded p-2">
                    {% for y in years %}
                        <option value="{{ y }}">{{ y }}</option>
                    {% endfor %}
                </select>
                <select id="country" class="border rounded p-2">
                    {% for c in countries %}
                        <option value="{{ c.iso_code }}">{{ c.name }}</option>
                    {% endfor %}
                </select>

                <button id="map-update-btn" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">ì—…ë°ì´íŠ¸
                </button>
            </div>

            <!-- ë°ì´í„° ìƒì„±ì¼ í‘œì‹œ -->
            <div class="flex justify-end mt-2">
                <p class="text-xs text-gray-500">Cropmask data generated on October 30</p>
            </div>
        </section>

        <!-- ğŸ—º ì§€ë„ + ğŸ“Š ê·¸ë˜í”„ -->
        <section class="flex flex-col lg:flex-row gap-6">

            <!-- ì™¼ìª½: ì§€ë„ -->
            <div class="flex-1 bg-white shadow-md rounded-xl p-4">
                <h2 class="text-lg font-semibold mb-2">ğŸ—ºï¸ ë‹¨ê³„êµ¬ë¶„ë„ ì§€ë„</h2>
                <div id="map" class="w-full h-[600px] rounded border"></div>

            </div>

            <!-- ì˜¤ë¥¸ìª½: ë°” ê·¸ë˜í”„ -->
            <div class="flex-1 bg-white shadow-md rounded-xl p-4">
                <h2 class="text-lg font-semibold mb-2">ğŸ“Š ì£¼ë³„ ì¬ë°° ë©´ì  ë¹„êµ</h2>
                <div id="area-bar" class="h-[400px]"></div>

                <!-- ğŸ”½ ë©´ì  ë¹„êµ í‘œ -->
                <div class="overflow-x-auto mt-4">
                    <table id="area-table" class="min-w-full text-sm text-center border-collapse">
                        <thead>
                        <tr class="bg-gray-100">
                            <th class="border p-2">State</th>
                            <th class="border p-2">í‰ë…„</th>
                            <th class="border p-2">ì „ë…„ë„</th>
                            <th class="border p-2">ì˜¬í•´</th>
                            <th class="border p-2">ì‘ë…„ëŒ€ë¹„ ì¦ê°%</th>
                        </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>

            </div>

        </section>


        <!-- ğŸ§ª NIRv ê·¸ë˜í”„ ì„¹ì…˜ -->
        <section class="mt-8 bg-white shadow-md rounded-xl p-6">
            <h2 class="text-lg font-semibold mb-4">ğŸŒ± NIRv ë‹¤ì¤‘ ì‹œê³„ì—´ ë¹„êµ</h2>

            <!-- íƒ­ ë©”ë‰´ -->
            <div class="flex border-b mb-4">
                <button id="tab-nirv" class="px-4 py-2 border-b-2 border-blue-500 text-blue-500 font-semibold">
                    NIRv ì‹œê³„ì—´
                </button>
                <button id="tab-zscore" class="px-4 py-2 border-b-2 border-transparent text-gray-500">
                    Z-score ë“±ê¸‰
                </button>
            </div>

            <!-- ë‹¤ì¤‘ ì‹œê³„ì—´ ì¹´ë“œ ì˜ì—­ -->
            <div id="multi-nirv-grid" class="grid grid-cols-1 md:grid-cols-2 gap-4"></div>

            <!-- Z-score ì¹´ë“œ ì˜ì—­ (ì´ˆê¸°ì—ëŠ” ìˆ¨ê¹€) -->
            <div id="multi-zscore-grid" class="grid grid-cols-1 md:grid-cols-2 gap-4 hidden"></div>
        </section>

    </div>

    <!-- ğŸ“¦ ìŠ¤í¬ë¦½íŠ¸ -->
    <script src="https://cdn.plot.ly/plotly-2.27.1.min.js"></script>
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <link href="https://unpkg.com/leaflet/dist/leaflet.css" rel="stylesheet"/>
    <script src="{% static 'js/area_map_logic.js' %}"></script>
    <script src="{% static 'js/nirv_plot_multi.js' %}"></script>

{% endblock %}
